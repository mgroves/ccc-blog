# Background jobs in ASP.NET made easy with Hangfire

(this is only an outline so far)

intro italics: Merry Christmas! This is part of the C# Advent. Make sure to check out all of the other great posts from 2017 and 2018. Look for C# Advent 2019 - author sign ups at the end of the October and blog posts starting on december 1st, 2019.

## what is a background job?
- scheduled
- fire and forget a time consuming operation (checking inventory, sending emails, etc)

## what you usually need to do to create background jobs
- separate windows service
- queueing mechanism like kafka or rabbit
- testing difficulties, deployment difficulties

## How hangfire works

https://www.hangfire.io/

point hangfire to a database
- sql server, couchbase, etc
- runs in the asp.net process itself, it's not a separate executable
- works in asp.net and asp.net core (I'm using it in asp.net core)

every asp.net server you deploy that points to hangfire uses the same pool
- scaling is easy
- restarting is easy
- testing is easy
- deployment is easy

## Example

I created an app for my own personal use to help me sort through all my family photos

It's mostly fast, except when I need to report on all 10000 images
I want to see my progress in categorizing images
what I initially did was create a 'score' document that would act as a cache of the score
it would expire every minute (or whatever) and then do the 'walk of shame'

--- example of walk of shame ---

I replaced it with a hangfire task that fires every minute and replaces the score document
so there's no longer a walk of shame -- the caching can happen in the background
in the gaps in time where I'm just looking at images

I setup hangfire to use Couchbase:

--- example of hangfire setup ---

Once that setup is complete, you can start scheduling jobs:

--- example of hangfire job ---

another example is that I created a job to search for new image files every hour
I just leave this running, and it watches my images folder
creating new image data for each file it finds

## This is only the start

hangfire built in dashboard

--- screenshot of dashboard ---

gotchas with deploying to azure/cloud

retries

--- screenshot of a recurring job and 'retry' button ---

hangfire pro features: batching, monitoring
 https://www.hangfire.io/pro/